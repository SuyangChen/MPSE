<!DOCTYPE html>
<html lang="en">

<head>

	<title>multiview3d</title>
	<meta charset="utf-8">

	<style>
		body {
			background-color: #000000;
			margin: 0px;
			overflow: hidden;
			font-family: Monospace;
			font-size: 13px;
			text-align: center;
			font-weight: bold;
			text-align: center;
		}

		a {
			color: #0078ff;
		}

		#info {
			color: #fff;
			position: absolute;
			top: 0px;
			width: 100%;
			padding: 5px;
			z-index: 100;
		}
	</style>

	<link rel="stylesheet" type="text/css" href="tooltip.css" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/107/three.js"></script>
	<script src="stats.js"></script>
	<!--		<script src="sqcirtr_123p1_coordinates_tmp.js"></script> -->
	<script src="vis_param.js"></script>
	<script src="coordinates.js"></script>

	<script
		type="text/javascript">var zoomfactor = 20; var view = Array(); view[0] = [0.3, 0, 35]; view[1] = [0, 35, 0]; view[2] = [35, 0, 0]; var last = view[0]</script>

	<script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
	<script src="label.js"></script>
	<script src="https://code.jquery.com/jquery-3.4.1.js"></script>

</head>

<body>


 
  
	<script>
		for (var i = 0; i < numberofprojection; i++) {

			document.write('<img src="eye.png" width="64px" onclick=vizx(view[' + i + '])>')
		}
	</script>


	<br>
	<div id=info></div>
	<script>

		function rainbow(n) {
			n = n * 240 / 255;
			return 'hsl(' + n + ',100%,50%)';
		}


		function getMaxMin() {
			min = labels[1][0]
			max = labels[1][0]
			for (var i = 0; i < points.length; i++) {
				v = labels[i][0]
				if (v < min) min = v
				if (v > max) max = v
			}
			return [min, max]
		}
		var minmax = getMaxMin()

		function hex(c) {
			var s = "0123456789abcdef";
			var i = parseInt(c);
			if (i == 0 || isNaN(c))
				return "00";
			i = Math.round(Math.min(Math.max(0, i), 255));
			return s.charAt((i - i % 16) / 16) + s.charAt(i % 16);
		}

		/* Convert an RGB triplet to a hex string */
		function convertToHex(rgb) {
			return hex(rgb[0]) + hex(rgb[1]) + hex(rgb[2]);
		}

		/* Remove '#' in color hex string */
		function trim(s) { return (s.charAt(0) == '#') ? s.substring(1, 7) : s }

		/* Convert a hex string to an RGB triplet */
		function convertToRGB(hex) {
			var color = [];
			color[0] = parseInt((trim(hex)).substring(0, 2), 16);
			color[1] = parseInt((trim(hex)).substring(2, 4), 16);
			color[2] = parseInt((trim(hex)).substring(4, 6), 16);
			return color;
		}

		function generateColor(colorStart, colorEnd, colorCount) {

			// The beginning of your gradient
			var start = convertToRGB(colorStart);

			// The end of your gradient
			var end = convertToRGB(colorEnd);

			// The number of colors to compute
			var len = colorCount;

			//Alpha blending amount
			var alpha = 0.0;

			var colorlist = [];

			for (i = 0; i < len; i++) {
				var c = [];
				alpha += (1.0 / len);

				c[0] = start[0] * alpha + (1 - alpha) * end[0];
				c[1] = start[1] * alpha + (1 - alpha) * end[1];
				c[2] = start[2] * alpha + (1 - alpha) * end[2];

				colorlist.push(convertToHex(c));

			}

			return colorlist;

		}


		//document.getElementById("info").innerHTML = "Iteration:" +  steps + " cost:" +cost + ", t:" + t;


		var scene = new THREE.Scene();
		var camera = new THREE.PerspectiveCamera(1, window.innerWidth / window.innerHeight, 1, 1000);
		var tooltipEnabledObjects = [];
		camera.position.set(0, 0, 35);
		camera.lookAt(scene.position);
		var renderer = new THREE.WebGLRenderer({
			antialias: true
		});
		renderer.setSize(window.innerWidth, window.innerHeight);
		document.body.appendChild(renderer.domElement);
		//scene.background = new THREE.Color( 0xffffff );

		//const fontJson = require( "./fonts/helvetiker_regular.typeface.json" );

		//var fontl = new THREE.FontLoader().load( "./fonts/helvetiker_regular.typeface.json" );
		//var font = new THREE.Font(fontl  );
		var controls = new THREE.OrbitControls(camera, renderer.domElement);
		var color = ["red", "green", "blue", "white", 'yellow', 'orange']
		var edu_order = { 'Lower secondary': 0, 'Secondary / secondary special': 1, 'Incomplete higher': 2, 'Higher education': 3 }
		var MF = { 'M': 0, 'F': 1 }

		//var texture1 = new THREE.TextureLoader().load('dot.png');
		//var texture1 = new THREE.TextureLoader().load('crate.gif');
		//x=new THREE.IcosahedronBufferGeometry(2)

		function vizx(point) {/*
			var p2 =[]
			p2 = last
			var change = []
			for ( var j = 0 ; j < 3; j++)
			{
				if ( last [j] < point[j])
				{
					change.push(0.1);
				}
				else if ( last [j] > point[j]) { change.push(-0.1);}
				else { change.push(0)}
			}
			var i = 0
			while ( i <1000)
			{
				var change_sum = 0
				for ( var j = 0 ; j < 3; j++)
				{
					
					if ( p2[j] == point[j]) {change[j]=0}
					p2[j] =Math.round((p2[j] +change[j])*100)/100
					change_sum +=Math.abs(change[j])
				}
				viz(p2)
				if (change_sum == 0 ) {return 0}
				console.log(p2)
			}
			last = point */
			viz(point)
		}





		var loader = new THREE.FontLoader();

 
		function draw_plane(p, c) {
			var f = 500
			var point1 = new THREE.Vector3(- f * p[3] / p[0], 0, 0);//x axis intersection
			var point2 = new THREE.Vector3(0, - f * p[3] / p[1], 0);//y axis intersection
			var point3 = new THREE.Vector3(0, 0, -f * p[3] / p[2]);//z axis intersection


			var geom = new THREE.Geometry();
			geom.vertices.push(point1);// adding vertices to geometry
			geom.vertices.push(point2);
			geom.vertices.push(point3);


			geom.faces.push(new THREE.Face4(0, 1, 2));
			var material = new THREE.MeshBasicMaterial({
				transparent: true, opacity: 0.5,
				color: c, // RGB hex color for material
				side: THREE.DoubleSide // do not hide object when viewing from back
			});
			scene.add(new THREE.Mesh(geom, material));
		}

		var tmpColor = generateColor('#FFFFFF', '#ff0ff0', points.length);


		function viz(point) {
			camera.position.set(point[0] * zoomfactor, point[1] * zoomfactor, point[2] * zoomfactor);
			camera.lookAt(scene.position)
			projection_selection = $("#projection_color_dropdown").val()

			for (var i = 0; i < points.length; i++) {
				var c = color[0];
				var x = points[i][0];
				var y = points[i][1];
				var z = points[i][2];
				var s=5;
				var dotGeometry = new THREE.Geometry();
				dotGeometry.vertices.push(new THREE.Vector3(points[i][0], points[i][1], points[i][2]));
				var dotMaterial = new THREE.PointsMaterial({ color: c, size: s, sizeAttenuation: false });
				var dot = new THREE.Points(dotGeometry, dotMaterial);
				scene.add(dot)
 
			}
		}

		viz(view[0])
		var worldAxis = new THREE.AxesHelper(40);
		scene.add(worldAxis);

		var idx = 0;
		var maxIdx = 10;

        /*window.addEventListener("mousemove", onMouseMove, false);
        window.addEventListener("mousedown", onMouseDown, false);*/

		var raycaster = new THREE.Raycaster();
		// var mouse = new THREE.Vector2();
		var intersects = [];

        /*function onMouseMove(event) {
          mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
          mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
        }

        function onMouseDown(event) {
          raycaster.setFromCamera(mouse, camera);

        }*/

		render();

		function render() {
			requestAnimationFrame(render);
			renderer.render(scene, camera);
		}

	</script>



	<script>

		document.getElementById("legend").innerHTML += "<h2>LEGEND:</h2>";
		document.getElementById("legend").innerHTML += "<h3> Eyes show distribution of:</h3>";
		document.getElementById("legend").innerHTML += "<p> <span class=\"eye\">Eye 1:</span> " + projection_des[0] + "</p>";
		document.getElementById("legend").innerHTML += "<p> <span class=\"eye\">Eye 2:</span> " + projection_des[1] + "</p>";
		//document.getElementById("legend").innerHTML += "<p> <span class=\"eye\">Eye 3:</span> " + projection_des[2] +"</p>";
		document.getElementById("legend").innerHTML += "<h3>Projection2 colors:</h3>"
		document.getElementById("legend").innerHTML += "Male"
		document.getElementById("legend").innerHTML += "<select>";
		/*	var legend = document.getElementById("legend").innerHTML;
			for (var i = 0; i < color_select.length;i+=1)
			{
				var opt = document.createElement('option');
			opt.value = color_select[i];
			opt.innerHTML = color_select[i];
			document.getElementById("legend").innerHTML+=opt;
		    
			}*/
		document.getElementById("legend").innerHTML += "</select>";
	</script>

	<script src="tooltip_f.js"></script>
</body>

</html>